global:
  domain: fhirhub.example.com
  storageClass: gp3

hapi-postgresql:
  database:
    password: ""  # Override via sealed-secret or external secret
  persistence:
    size: 50Gi
  resources:
    requests:
      cpu: 500m
      memory: 1Gi
    limits:
      cpu: "2"
      memory: 2Gi

keycloak-postgresql:
  database:
    password: ""
  persistence:
    size: 20Gi
  resources:
    requests:
      cpu: 250m
      memory: 512Mi
    limits:
      cpu: "1"
      memory: 1Gi

hapi-fhir:
  replicaCount: 2
  database:
    password: ""
  hpa:
    enabled: true
    minReplicas: 2
    maxReplicas: 5
    targetCPU: 80
  resources:
    requests:
      cpu: 500m
      memory: 2Gi
    limits:
      cpu: "2"
      memory: 4Gi

keycloak:
  admin:
    password: ""
  database:
    password: ""
  hostname: auth.fhirhub.example.com
  ingress:
    enabled: true
    annotations:
      cert-manager.io/cluster-issuer: letsencrypt-prod
    hosts:
      - host: auth.fhirhub.example.com
        paths:
          - path: /
            pathType: Prefix
    tls:
      - secretName: keycloak-tls
        hosts:
          - auth.fhirhub.example.com

fhirhub-api:
  replicaCount: 3
  secrets:
    keycloakBackendClientSecret: ""
  ingress:
    enabled: true
    annotations:
      cert-manager.io/cluster-issuer: letsencrypt-prod
      nginx.ingress.kubernetes.io/rate-limit: "100"
      nginx.ingress.kubernetes.io/rate-limit-window: "1m"
    hosts:
      - host: fhirhub.example.com
        paths:
          - path: /api(/|$)(.*)
            pathType: ImplementationSpecific
    tls:
      - secretName: api-tls
        hosts:
          - fhirhub.example.com
  hpa:
    enabled: true
    minReplicas: 3
    maxReplicas: 10
    targetCPU: 70
  pdb:
    enabled: true
    minAvailable: 2
  resources:
    requests:
      cpu: 250m
      memory: 512Mi
    limits:
      cpu: "1"
      memory: 1Gi
  serviceMonitor:
    enabled: true

fhirhub-frontend:
  replicaCount: 3
  ingress:
    enabled: true
    annotations:
      cert-manager.io/cluster-issuer: letsencrypt-prod
    hosts:
      - host: fhirhub.example.com
        paths:
          - path: /
            pathType: Prefix
    tls:
      - secretName: frontend-tls
        hosts:
          - fhirhub.example.com
  hpa:
    enabled: true
    minReplicas: 3
    maxReplicas: 10
    targetCPU: 70
  pdb:
    enabled: true
    minAvailable: 2
  resources:
    requests:
      cpu: 100m
      memory: 256Mi
    limits:
      cpu: 500m
      memory: 512Mi
  serviceMonitor:
    enabled: true
